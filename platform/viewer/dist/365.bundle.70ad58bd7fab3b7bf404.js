"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[365],{68365:(e,t,r)=>{r.r(t),r.d(t,{default:()=>Le});var n=r(32735),i=r(12788),o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},o(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function s(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{};var c=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},u="object"==typeof l&&l&&l.Object===Object&&l,p="object"==typeof self&&self&&self.Object===Object&&self,d=u||p||Function("return this")(),f=d,m=function(){return f.Date.now()},v=/\s/;var g=function(e){for(var t=e.length;t--&&v.test(e.charAt(t)););return t},w=/^\s+/;var E=function(e){return e?e.slice(0,g(e)+1).replace(w,""):e},I=d.Symbol,b=I,h=Object.prototype,y=h.hasOwnProperty,S=h.toString,O=b?b.toStringTag:void 0;var T=function(e){var t=y.call(e,O),r=e[O];try{e[O]=void 0;var n=!0}catch(e){}var i=S.call(e);return n&&(t?e[O]=r:delete e[O]),i},x=Object.prototype.toString;var D=T,V=function(e){return x.call(e)},C=I?I.toStringTag:void 0;var R=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":C&&C in Object(e)?D(e):V(e)},M=function(e){return null!=e&&"object"==typeof e};var A=E,N=c,L=function(e){return"symbol"==typeof e||M(e)&&"[object Symbol]"==R(e)},_=/^[-+]0x[0-9a-f]+$/i,Z=/^0b[01]+$/i,P=/^0o[0-7]+$/i,j=parseInt;var H=c,k=m,W=function(e){if("number"==typeof e)return e;if(L(e))return NaN;if(N(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=N(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=A(e);var r=Z.test(e);return r||P.test(e)?j(e.slice(2),r?2:8):_.test(e)?NaN:+e},G=Math.max,z=Math.min;var U=function(e,t,r){var n,i,o,a,s,l,c=0,u=!1,p=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var r=n,o=i;return n=i=void 0,c=t,a=e.apply(o,r)}function m(e){return c=e,s=setTimeout(g,t),u?f(e):a}function v(e){var r=e-l;return void 0===l||r>=t||r<0||p&&e-c>=o}function g(){var e=k();if(v(e))return w(e);s=setTimeout(g,function(e){var r=t-(e-l);return p?z(r,o-(e-c)):r}(e))}function w(e){return s=void 0,d&&n?f(e):(n=i=void 0,a)}function E(){var e=k(),r=v(e);if(n=arguments,i=this,l=e,r){if(void 0===s)return m(l);if(p)return clearTimeout(s),s=setTimeout(g,t),f(l)}return void 0===s&&(s=setTimeout(g,t)),a}return t=W(t)||0,H(r)&&(u=!!r.leading,o=(p="maxWait"in r)?G(W(r.maxWait)||0,t):o,d="trailing"in r?!!r.trailing:d),E.cancel=function(){void 0!==s&&clearTimeout(s),c=0,n=l=i=s=void 0},E.flush=function(){return void 0===s?a:w(k())},E},F=U,B=c;var q=function(e,t,r){var n=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return B(r)&&(n="leading"in r?!!r.leading:n,i="trailing"in r?!!r.trailing:i),F(e,t,{leading:n,maxWait:t,trailing:i})},$=function(e,t,r,n){switch(t){case"debounce":return U(e,r,n);case"throttle":return q(e,r,n);default:return e}},K=function(e){return"function"==typeof e},J=function(){return"undefined"==typeof window},Y=function(e){return e instanceof Element||e instanceof HTMLDocument},Q=function(e,t,r,n){return function(i){var o=i.width,a=i.height;t((function(t){return t.width===o&&t.height===a||t.width===o&&!n||t.height===a&&!r?t:(e&&K(e)&&e(o,a),{width:o,height:a})}))}},X=function(e){function t(t){var r=e.call(this,t)||this;r.cancelHandler=function(){r.resizeHandler&&r.resizeHandler.cancel&&(r.resizeHandler.cancel(),r.resizeHandler=null)},r.attachObserver=function(){var e=r.props,t=e.targetRef,n=e.observerOptions;if(!J()){t&&t.current&&(r.targetRef.current=t.current);var i=r.getElement();i&&(r.observableElement&&r.observableElement===i||(r.observableElement=i,r.resizeObserver.observe(i,n)))}},r.getElement=function(){var e=r.props,t=e.querySelector,n=e.targetDomEl;if(J())return null;if(t)return document.querySelector(t);if(n&&Y(n))return n;if(r.targetRef&&Y(r.targetRef.current))return r.targetRef.current;var o=(0,i.findDOMNode)(r);if(!o)return null;switch(r.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return o;default:return o.parentElement}},r.createResizeHandler=function(e){var t=r.props,n=t.handleWidth,i=void 0===n||n,o=t.handleHeight,a=void 0===o||o,s=t.onResize;if(i||a){var l=Q(s,r.setState.bind(r),i,a);e.forEach((function(e){var t=e&&e.contentRect||{},n=t.width,i=t.height;!r.skipOnMount&&!J()&&l({width:n,height:i}),r.skipOnMount=!1}))}},r.getRenderType=function(){var e=r.props,t=e.render,i=e.children;return K(t)?"renderProp":K(i)?"childFunction":(0,n.isValidElement)(i)?"child":Array.isArray(i)?"childArray":"parent"};var o=t.skipOnMount,a=t.refreshMode,s=t.refreshRate,l=void 0===s?1e3:s,c=t.refreshOptions;return r.state={width:void 0,height:void 0},r.skipOnMount=o,r.targetRef=(0,n.createRef)(),r.observableElement=null,J()||(r.resizeHandler=$(r.createResizeHandler,a,l,c),r.resizeObserver=new window.ResizeObserver(r.resizeHandler)),r}return a(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){J()||(this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var e,t=this.props,r=t.render,i=t.children,o=t.nodeType,a=void 0===o?"div":o,l=this.state,c={width:l.width,height:l.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return r&&r(c);case"childFunction":return(e=i)(c);case"child":if((e=i).type&&"string"==typeof e.type){var u=s(c,["targetRef"]);return(0,n.cloneElement)(e,u)}return(0,n.cloneElement)(e,c);case"childArray":return(e=i).map((function(e){return!!e&&(0,n.cloneElement)(e,c)}));default:return n.createElement(a,null)}},t}(n.PureComponent);J()?n.useEffect:n.useLayoutEffect;var ee=r(60216),te=r.n(ee),re=r(3278),ne=r(54270),ie=r(26952),oe=r(96656),ae=r(88251),se=r(50029),le=r(53076),ce=r(36884),ue=r(21922),pe=r(44685),de=r(52916),fe=r(43194);function me(e){let{viewportData:t,viewportIndex:r,element:i,imageSliceData:o,setImageSliceData:a,scrollbarHeight:s,servicesManager:l}=e;const{CineService:c,CornerstoneViewportService:u}=l.services;return(0,n.useEffect)((()=>{if(!t)return;const e=u.getCornerstoneViewportByIndex(r);if(e)if(t.viewportType!==pe.Z.STACK){if(t.viewportType===pe.Z.ORTHOGRAPHIC){const t=de.Z(e);if(!t)return;const{imageIndex:r,numberOfSlices:n}=t;a({imageIndex:r,numberOfSlices:n})}}else{const r=e.getCurrentImageIdIndex();a({imageIndex:r,numberOfSlices:t.data.imageIds.length})}}),[r,t]),(0,n.useEffect)((()=>{if(t?.viewportType!==pe.Z.STACK)return;const e=e=>{const{newImageIdIndex:r}=e.detail;a({imageIndex:r,numberOfSlices:t.data.imageIds.length})};return i.addEventListener(oe.Z.STACK_VIEWPORT_SCROLL,e),()=>{i.removeEventListener(oe.Z.STACK_VIEWPORT_SCROLL,e)}}),[t,i]),(0,n.useEffect)((()=>{if(t?.viewportType!==pe.Z.ORTHOGRAPHIC)return;const e=e=>{const{imageIndex:t,numberOfSlices:r}=e.detail;a({imageIndex:t,numberOfSlices:r})};return i.addEventListener(oe.Z.VOLUME_NEW_IMAGE,e),()=>{i.removeEventListener(oe.Z.VOLUME_NEW_IMAGE,e)}}),[t,i]),n.createElement(fe.ImageScrollbar,{onChange:e=>((e,t)=>{const r=u.getViewportInfoByIndex(t).getViewportId(),n=u.getCornerstoneViewport(r),{isCineEnabled:o}=c.getState();o&&(c.stopClip(i),c.setCine({id:t,isPlaying:!1})),re.Z(n.element,{imageIndex:e,debounceLoading:!0})})(e,r),max:o.numberOfSlices?o.numberOfSlices-1:0,height:s,value:o.imageIndex})}me.propTypes={viewportData:te().object,viewportIndex:te().number.isRequired,element:te().instanceOf(Element),scrollbarHeight:te().string,imageSliceData:te().object.isRequired,setImageSliceData:te().func.isRequired};const ve=me;var ge=r(6807),we=r(5832),Ee=r(1136);const Ie=1e-4;function be(e){let{element:t,viewportData:r,imageSliceData:i,viewportIndex:o,servicesManager:a}=e;const{CornerstoneViewportService:s,ToolBarService:l}=a.services,[c,u]=(0,n.useState)({windowCenter:null,windowWidth:null}),[p,d]=(0,n.useState)(1),[f,m]=(0,n.useState)([]);(0,n.useEffect)((()=>{m(l.getActiveTools())}),[]),(0,n.useEffect)((()=>{let e=!0;const{unsubscribe:t}=l.subscribe(l.EVENTS.TOOL_BAR_STATE_MODIFIED,(()=>{e&&m(l.getActiveTools())}));return()=>{e=!1,t()}}),[]),(0,n.useEffect)((()=>{const e=e=>{const{range:t}=e.detail;if(!t)return;const{lower:r,upper:n}=t,{windowWidth:i,windowCenter:o}=we.toWindowLevel(r,n);u({windowCenter:o,windowWidth:i})};return t.addEventListener(oe.Z.VOI_MODIFIED,e),()=>{t.removeEventListener(oe.Z.VOI_MODIFIED,e)}}),[o,r,c,t]),(0,n.useEffect)((()=>{const e=e=>{const{previousCamera:r,camera:n}=e.detail;if(r.parallelScale!==n.parallelScale||r.scale!==n.scale){const e=s.getCornerstoneViewportByIndex(o);if(!e)return;const r=e.getImageData();if(!r)return;if(n.scale)return void d(n.scale);const{spacing:i}=r,a=t.clientHeight*i[0]*.5/n.parallelScale;d(a)}};return t.addEventListener(oe.Z.CAMERA_MODIFIED,e),()=>{t.removeEventListener(oe.Z.CAMERA_MODIFIED,e)}}),[o,r]);const v=(0,n.useCallback)((()=>{const{windowWidth:e,windowCenter:t}=c;return f.includes("WindowLevel")?"number"!=typeof t||"number"!=typeof e?null:n.createElement("div",{className:"flex flex-row"},n.createElement("span",{className:"mr-1"},"W:"),n.createElement("span",{className:"ml-1 mr-2 font-light"},e.toFixed(0)),n.createElement("span",{className:"mr-1"},"L:"),n.createElement("span",{className:"ml-1 font-light"},t.toFixed(0))):f.includes("Zoom")?n.createElement("div",{className:"flex flex-row"},n.createElement("span",{className:"mr-1"},"Zoom:"),n.createElement("span",{className:"font-light"},p.toFixed(2),"x")):null}),[c,p,f]),g=(0,n.useCallback)((()=>{const{imageIndex:e,numberOfSlices:t}=i;if(!r)return;let a;if(r.viewportType===pe.Z.STACK){if(a=function(e,t){const r=e.data.imageIds,n=r[t];if(!n)return;const i=Ee.get("generalImageModule",n)||{},{instanceNumber:o}=i;if(r.length<=1)return;return parseInt(o)}(r,e),!a)return null}else r.viewportType===pe.Z.ORTHOGRAPHIC&&(a=function(e,t,r,n){const i=e.data.map((e=>e.volume));if(!i||i.length>1)return;const o=i[0],{direction:a,imageIds:s}=o,l=n.getCornerstoneViewportByIndex(r);if(!l)return;const c=l.getCamera(),{viewPlaneNormal:u}=c,p=a.slice(6,9),d=ge.cross(ge.create(),u,p);if(ge.length(d)<Ie){const e=s[t];if(!e)return{};const{instanceNumber:r}=Ee.get("generalImageModule",e)||{};return parseInt(r)}}(r,e,o,s));return n.createElement("div",{className:"flex flex-row"},n.createElement("span",{className:"mr-1"},"I:"),n.createElement("span",{className:"font-light"},void 0!==a?`${a} (${e+1}/${t})`:`${e+1}/${t}`))}),[i,r,o]);return r?n.createElement(fe.ViewportOverlay,{topLeft:v(),topRight:g()}):null}be.propTypes={viewportData:te().object,imageIndex:te().number,viewportIndex:te().number};const he=be;var ye=r(2883);const{getOrientationStringLPS:Se,invertOrientationStringLPS:Oe}=ye;function Te(e){let{element:t,viewportData:r,imageSliceData:i,viewportIndex:o,servicesManager:a,orientationMarkers:s=["top","left"]}=e;const[l,c]=(0,n.useState)(0),[u,p]=(0,n.useState)(!1),[d,f]=(0,n.useState)(!1),{CornerstoneViewportService:m}=a.services;(0,n.useEffect)((()=>{const e=e=>{const{rotation:t,previousCamera:r,camera:n}=e.detail;void 0!==t&&c(t),void 0!==n.flipHorizontal&&r.flipHorizontal!==n.flipHorizontal&&p(n.flipHorizontal),void 0!==n.flipVertical&&r.flipVertical!==n.flipVertical&&f(n.flipVertical)};return t.addEventListener(oe.Z.CAMERA_MODIFIED,e),()=>{t.removeEventListener(oe.Z.CAMERA_MODIFIED,e)}}),[]);const v=(0,n.useMemo)((()=>{if(!r)return"";let e,a;if("stack"===r.viewportType){const t=i.imageIndex,n=r.data.imageIds?.[t];if(!n)return!1;({rowCosines:e,columnCosines:a}=Ee.get("imagePlaneModule",n)||{})}else{if(!t||!(0,ae.ZP)(t))return"";const{viewport:r}=(0,ae.ZP)(t),{viewUp:n,viewPlaneNormal:i}=r.getCamera(),o=ge.create();ge.cross(o,n,i),a=[-n[0],-n[1],-n[2]],e=o}if(!e||!a||void 0===l)return"";const c=function(e,t,r,n,i){const o=Se(e),a=Se(t),s=Oe(o),l={top:Oe(a),left:s,right:o,bottom:a};n&&(l.top=Oe(l.top),l.bottom=Oe(l.bottom));i&&(l.left=Oe(l.left),l.right=Oe(l.right));if(90===r||-270===r)return{top:l.left,left:Oe(l.top),right:Oe(l.bottom),bottom:l.right};if(-90===r||270===r)return{top:Oe(l.left),left:l.top,bottom:l.left,right:l.bottom};if(180===r||-180===r)return{top:Oe(l.top),left:Oe(l.left),bottom:Oe(l.bottom),right:Oe(l.right)};return l}(e,a,l,d,u),p=m.getViewportInfoByIndex(o).getViewportOptions().background;!!p&&le.Z(p,[1,1,1]);return s.map(((e,t)=>n.createElement("div",{className:`${e}-mid orientation-marker`,key:`${e}-mid orientation-marker`},n.createElement("div",{className:"orientation-marker-value"},c[e]))))}),[r,i,l,d,u,s,t]);return n.createElement("div",{className:"ViewportOrientationMarkers noselect"},v)}Te.propTypes={percentComplete:te().number,error:te().object},Te.defaultProps={percentComplete:0,error:null};const xe=Te;function De(e){let{viewportData:t,element:r}=e;const[i,o]=(0,n.useState)(!1),[a,s]=(0,n.useState)(!1),l=(0,n.useRef)(null),c=(0,n.useRef)(null),u=e=>{clearTimeout(l.current),l.current=setTimeout((()=>{o(!0)}),50)},p=e=>{clearTimeout(l.current),o(!1)},d=e=>{clearTimeout(l.current),c.current===e.detail.imageId&&(s(e.detail.error),c.current=null)};return(0,n.useEffect)((()=>(r.addEventListener(oe.Z.STACK_VIEWPORT_SCROLL,u),r.addEventListener(oe.Z.IMAGE_LOAD_ERROR,d),r.addEventListener(oe.Z.STACK_NEW_IMAGE,p),()=>{r.removeEventListener(oe.Z.STACK_VIEWPORT_SCROLL,u),r.removeEventListener(oe.Z.STACK_NEW_IMAGE,p),r.removeEventListener(oe.Z.IMAGE_LOAD_ERROR,d)})),[r,t]),a?n.createElement(n.Fragment,null,n.createElement("div",{className:"bg-black opacity-50 absolute h-full w-full top-0 left-0"},n.createElement("div",{className:"flex transparent items-center justify-center w-full h-full"},n.createElement("p",{className:"text-primary-light text-xl font-light"},n.createElement("h4",null,"Error Loading Image"),n.createElement("p",null,"An error has occurred."),n.createElement("p",null,a))))):i?n.createElement("div",{className:"pointer-events-none bg-black opacity-50 absolute h-full w-full top-0 left-0"},n.createElement("div",{className:"flex transparent items-center justify-center w-full h-full"},n.createElement("p",{className:"text-primary-light text-xl font-light"},"Loading..."))):null}De.propTypes={percentComplete:te().number,error:te().object,element:te().object},De.defaultProps={percentComplete:0,error:null};const Ve=De;const Ce=function(e){const{viewportIndex:t,element:r,scrollbarHeight:i,servicesManager:o}=e,{disableViewportImageScrollbar:a,disableViewportOverlay:s,disableViewportImageSliceLoadingIndicator:l,disableViewportOrientationMarkers:c}=e,{CornerstoneViewportService:u,CornerstoneCacheService:p}=o.services,[d,f]=(0,n.useState)({imageIndex:0,numberOfSlices:0}),[m,v]=(0,n.useState)(null);if((0,n.useEffect)((()=>{const{unsubscribe:e}=u.subscribe(u.EVENTS.VIEWPORT_DATA_CHANGED,(e=>{e.viewportIndex===t&&v(e.viewportData)}));return()=>{e()}}),[t]),!r)return null;if(m){if(u.getViewportInfoByIndex(t)?.viewportOptions?.customViewportProps?.hideOverlays)return null}return n.createElement("div",{className:"noselect"},!a&&n.createElement(ve,{viewportIndex:t,viewportData:m,element:r,imageSliceData:d,setImageSliceData:f,scrollbarHeight:i,servicesManager:o}),!s&&n.createElement(he,{imageSliceData:d,viewportData:m,viewportIndex:t,servicesManager:o,element:r}),!l&&n.createElement(Ve,{viewportData:m,element:r}),!c&&n.createElement(xe,{imageSliceData:d,element:r,viewportData:m,servicesManager:o,viewportIndex:t}))};var Re=r(63130);function Me(e,t){if(t.needsRerendering)return!1;if(e.displaySets.length!==t.displaySets.length)return!1;if(e.viewportOptions.orientation!==t.viewportOptions.orientation)return!1;if(e.viewportOptions.viewportType!==t.viewportOptions.viewportType)return!1;const r=e.displaySets,n=t.displaySets;if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++){const t=r[e],i=n.find((e=>e.displaySetInstanceUID===t.displaySetInstanceUID));if(!i)return!1;if(i.images?.length!==t.images?.length)return!1;if(i.images?.length)for(let e=0;e<i.images.length;e++)if(i.images[e].imageId!==t.images[e].imageId)return!1}return!0}const Ae=n.memo(n.forwardRef(((e,t)=>{const{viewportIndex:r,displaySets:i,dataSource:o,viewportOptions:a,displaySetOptions:s,servicesManager:l,onElementEnabled:c,onElementDisabled:u,initialImageIndex:p,disableViewportImageScrollbar:d,disableViewportOverlay:f,disableViewportImageSliceLoadingIndicator:m,disableViewportOrientationMarkers:v}=e,[g,w]=(0,n.useState)("100px"),E=(0,n.useRef)();n.useImperativeHandle(t,(()=>E.current));const{MeasurementService:I,DisplaySetService:b,ToolBarService:h,ToolGroupService:y,SyncGroupService:S,CornerstoneViewportService:O,CornerstoneCacheService:T,ViewportGridService:x}=l.services,D=(0,n.useCallback)((()=>{const e=E.current.clientHeight-20+"px";w(e)}),[E]),V=(0,n.useCallback)((()=>{E.current&&(O.resize(),D())}),[E]),C=(0,n.useCallback)((e=>{if(e.detail.element!==E.current)return;const{viewportId:t,element:r}=e.detail,n=O.getViewportInfo(t),i=n.getViewportIndex();(0,ue.Yc)(i,r);const o=n.getRenderingEngineId(),a=n.getToolGroupId(),s=n.getSyncGroups();y.addViewportToToolGroup(t,o,a),S.addViewportToSyncGroup(t,o,s),c&&c(e)}),[r,c,y]);return(0,n.useEffect)((()=>(O.enableViewport(r,a,E.current),ie.Z.addEventListener(oe.Z.ELEMENT_ENABLED,C),D(),()=>{const e=O.getViewportInfoByIndex(r),t=e.getViewportId(),n=e.getRenderingEngineId(),i=e.getSyncGroups();y.removeViewportFromToolGroup(t,n),S.removeViewportFromSyncGroup(t,n,i),O.disableElement(r),u&&u(e),ie.Z.removeEventListener(oe.Z.ELEMENT_ENABLED,C)})),[]),(0,n.useEffect)((()=>{const{unsubscribe:e}=b.subscribe(b.EVENTS.DISPLAY_SET_SERIES_METADATA_INVALIDATED,(async e=>{const t=O.getViewportInfoByIndex(r);if(t.hasDisplaySet(e)){const n=t.getViewportData(),i=await T.invalidateViewportData(n,e,o,b),a=!0;O.updateViewport(r,i,a)}}));return()=>{e()}}),[r]),(0,n.useEffect)((()=>{a.viewportType||(a.viewportType="stack");(async()=>{const e=await T.createViewportData(i,a,o,p);O.setViewportData(r,e,a,s)})()}),[a,i,o]),(0,n.useEffect)((()=>{const e=function(e,t,r,n,i,o,a){const s=i.map((e=>e.displaySetInstanceUID)),{unsubscribe:l}=e.subscribe(e.EVENTS.JUMP_TO_MEASUREMENT,(i=>{let{measurement:l}=i;l&&s.includes(l.displaySetInstanceUID)&&Ne(l,r,n,e,t,o,a)}));return l}(I,b,E,r,i,x,O);return function(e,t,r,n,i,o,a){const s=i.map((e=>e.displaySetInstanceUID)),l=e.getJumpToMeasurement(n);if(l&&r){const i=e.getMeasurement(l);s.includes(i.displaySetInstanceUID)&&Ne(i,r,n,e,t,o,a)}}(I,b,E,r,i,x,O),()=>{e()}}),[i,E,r]),n.createElement("div",{className:"viewport-wrapper"},n.createElement(X,{handleWidth:!0,handleHeight:!0,skipOnMount:!0,refreshMode:"throttle",refreshRate:100,onResize:V,targetRef:E.current}),n.createElement("div",{className:"cornerstone-viewport-element",style:{height:"100%",width:"100%"},onContextMenu:e=>e.preventDefault(),onMouseDown:e=>e.preventDefault(),ref:E}),n.createElement(Ce,{disableViewportImageScrollbar:d,disableViewportOverlay:f,disableViewportImageSliceLoadingIndicator:m,disableViewportOrientationMarkers:v,viewportIndex:r,ToolBarService:h,element:E.current,scrollbarHeight:g,servicesManager:l}))})),Me);function Ne(e,t,r,n,i,o,a){const s=t.current,{displaySetInstanceUID:l,SOPInstanceUID:c,frameNumber:u}=e;c||console.warn("cannot jump in a non-acquisition plane measurements yet");const p=i.getDisplaySetByUID(l);o.setActiveViewportIndex(r);const d=(0,ae.ZP)(s),f=a.getViewportInfoByIndex(r);if(d){const t=d.viewport;let i=0,o=!0;if(t instanceof se.Z){i=t.getImageIds().findIndex((e=>{const{SOPInstanceUID:t,frameNumber:r}=(0,Re.Z)(e);return t===c&&(!u||u===r)}))}else{const{viewPlaneNormal:t}=e.metadata;i=p.images.findIndex((e=>e.SOPInstanceUID===c));const{orientation:r}=f.getViewportOptions();r&&t&&!le.Z(ce.Z[r]?.viewPlaneNormal,t)&&(o=!1)}if(!o||-1===i)return;re.Z(s,{imageIndex:i}),ne.setAnnotationSelected(e.uid),n.removeJumpToMeasurement(r)}}Ae.displayName="OHIFCornerstoneViewport",Ae.propTypes={viewportIndex:te().number.isRequired,displaySets:te().array.isRequired,dataSource:te().object.isRequired,viewportOptions:te().object,displaySetOptions:te().arrayOf(te().any),servicesManager:te().object.isRequired,onElementEnabled:te().func,initialImageIdOrIndex:te().oneOfType([te().string,te().number])};const Le=Ae}}]);
//# sourceMappingURL=365.bundle.70ad58bd7fab3b7bf404.js.map