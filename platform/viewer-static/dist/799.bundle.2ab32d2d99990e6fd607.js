"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[799],{91799:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var a=n(32735),i=n(60216),r=n.n(i),s=n(72928),o=n(84334),l=n(43194),c=n(38942),m=n(26952),u=n(96656),d=n(49756),p=n(56789);function f(){return f=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f.apply(this,arguments)}const{formatDate:g}=s.ZP;function w(e){const{children:t,displaySets:n,viewportIndex:i,viewportLabel:r,servicesManager:s,extensionManager:w,commandsManager:E}=e,{t:S}=(0,c.$G)("TrackedViewport"),{MeasurementService:v,CornerstoneViewportService:b}=s.services,h=n[0],[y]=(0,p.I)(),[{activeViewportIndex:C}]=(0,l.useViewportGrid)(),[{isCineEnabled:x,cines:P},N]=(0,l.useCine)(),[k]=(0,l.useViewportDialog)(),[I,T]=(0,a.useState)(!1),[M,D]=(0,a.useState)(null),[V,A]=(0,a.useState)(null),{trackedSeries:R}=y.context,O=b.getViewportId(i),{Modality:Z,SeriesDate:F,SeriesDescription:j,SeriesInstanceUID:_,SeriesNumber:K}=h,{PatientID:W,PatientName:$,PatientSex:q,PatientAge:L,SliceThickness:B,SpacingBetweenSlices:G,ManufacturerModelName:U}=h.images[0],z=()=>{if(!P||!P[i]||!V)return;const e=P[i],t=e.isPlaying||!1,n=e.frameRate||24,a=Math.max(n,1);t?N.playClip(V,{framesPerSecond:a}):N.stopClip(V)};(0,a.useEffect)((()=>I?(d.Z.setViewportToolStyles(O,{global:{lineDash:""}}),void b.getRenderingEngine().renderViewport(O)):(d.Z.setViewportToolStyles(`viewport-${i}`,{global:{lineDash:"4,4"}}),b.getRenderingEngine().renderViewport(O),()=>{d.Z.setViewportToolStyles(O,{})})),[I]),(0,a.useEffect)((()=>(m.Z.addEventListener(u.Z.STACK_VIEWPORT_NEW_STACK,z),()=>{N.setCine({id:i,isPlaying:!1}),m.Z.removeEventListener(u.Z.STACK_VIEWPORT_NEW_STACK,z)})),[V]),(0,a.useEffect)((()=>{if(P&&P[i]&&V)return z(),()=>{V&&P?.[i]?.isPlaying&&N.stopClip(V)}}),[P,i,N,V,z]),R.includes(_)!==I&&T(!I);const H=e=>{A(e.detail.element)};const J=P[i],Q=J&&J.isPlaying||!1;return a.createElement(a.Fragment,null,a.createElement(l.ViewportActionBar,{onDoubleClick:e=>{e.stopPropagation(),e.preventDefault()},useAltStyling:I,onArrowsClick:e=>function(e){const t=function(e,t,n,a){const{MeasurementService:i}=t.services,r=i.getMeasurements(),{trackedSeries:s}=a.context,o=r.filter((e=>s.includes(e.referenceSeriesUID)));if(!o.length)return;const l=o.length,c=o.map((e=>e.uid));let m=c.findIndex((e=>e===n));return-1===m?m=0:"left"===e?(m--,m<0&&(m=l-1)):"right"===e&&(m++,m===l&&(m=0)),c[m]}(e,s,M,y);t&&(D(t),v.jumpToMeasurement(i,t))}(e),getStatusComponent:()=>function(e){const t=e?"tracked":"dotted-circle";return a.createElement("div",{className:"relative"},a.createElement(l.Tooltip,{position:"bottom-left",content:a.createElement("div",{className:"flex py-2"},a.createElement("div",{className:"flex pt-1"},a.createElement(l.Icon,{name:"info-link",className:"w-4 text-primary-main"})),a.createElement("div",{className:"flex ml-4"},a.createElement("span",{className:"text-base text-common-light"},e?a.createElement(a.Fragment,null,"Series is",a.createElement("span",{className:"font-bold text-white"}," tracked")," and can be viewed ",a.createElement("br",null)," in the measurement panel"):a.createElement(a.Fragment,null,"Measurements for",a.createElement("span",{className:"font-bold text-white"}," untracked "),"series ",a.createElement("br",null)," will not be shown in the ",a.createElement("br",null)," measurements panel"))))},a.createElement(l.Icon,{name:t,className:"w-6 text-primary-light"})))}(I),studyData:{label:r,studyDate:g(F),currentSeries:K,seriesDescription:j,patientInformation:{patientName:$?o.ZP.utils.formatPN($.Alphabetic):"",patientSex:q||"",patientAge:L||"",MRN:W||"",thickness:B?`${parseFloat(B).toFixed(2)}mm`:"",spacing:void 0!==G?`${parseFloat(G).toFixed(2)}mm`:"",scanner:U||""}},showNavArrows:!x,showCine:x,cineProps:{isPlaying:Q,onClose:()=>E.runCommand("toggleCine"),onPlayPauseChange:e=>N.setCine({id:C,isPlaying:e}),onFrameRateChange:e=>N.setCine({id:C,frameRate:e})}}),a.createElement("div",{className:"relative flex flex-row w-full h-full overflow-hidden"},(()=>{const{component:t}=w.getModuleEntry("@ohif/extension-cornerstone.viewportModule.cornerstone");return a.createElement(t,f({},e,{onElementEnabled:H}))})(),a.createElement("div",{className:"absolute w-full"},k.viewportIndex===i&&a.createElement(l.Notification,{id:k.id,message:k.message,type:k.type,actions:k.actions,onSubmit:k.onSubmit,onOutsideClick:k.onOutsideClick}))))}w.propTypes={displaySets:r().arrayOf(r().object.isRequired).isRequired,viewportIndex:r().number.isRequired,dataSource:r().object,children:r().node,customProps:r().object},w.defaultProps={customProps:{}};const E=w}}]);
//# sourceMappingURL=799.bundle.2ab32d2d99990e6fd607.js.map